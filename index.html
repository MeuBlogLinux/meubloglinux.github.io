<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Linux Lab - Tech & Games</title>
    <meta name="theme-color" content="#050505">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- ESTILO CYBERPUNK --- */
        :root { --bg: #050505; --neon-green: #00ff41; --neon-blue: #00f3ff; --card-bg: #111; --font: 'Fira Code', monospace; }
        body { background-color: var(--bg); font-family: var(--font); color: #ddd; padding-top: 60px; }

        /* HEADER FIXO */
        .cyber-nav {
            position: fixed; top: 0; left: 0; width: 100%; background: rgba(0,0,0,0.9);
            border-bottom: 1px solid var(--neon-green); padding: 10px 20px; z-index: 999;
            display: flex; justify-content: space-between; align-items: center;
            backdrop-filter: blur(5px);
        }
        .cyber-nav a { color: var(--neon-green); text-decoration: none; margin-left: 20px; font-weight: bold; cursor: pointer; }
        .cyber-nav a:hover { color: #fff; text-shadow: 0 0 10px var(--neon-green); }

        /* CARDS */
        .card-post {
            background-color: var(--card-bg); border: 1px solid #333; border-left: 3px solid var(--neon-green);
            border-radius: 8px; margin-bottom: 25px; padding: 20px; transition: 0.2s;
        }
        .card-post:hover { border-color: var(--neon-green); box-shadow: 0 0 10px rgba(0,255,65,0.1); }

        /* BOT√ÉO DE CURTIR */
        .btn-like {
            background: #1a1a1a; border: 1px solid #333; color: #666; 
            padding: 5px 15px; border-radius: 20px; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;
            transition: 0.3s;
        }
        .btn-like.curtido {
            border-color: #ff0041; color: #ff0041; background: rgba(255,0,65,0.1);
        }
        .btn-like:hover { transform: scale(1.05); }

        /* TELAS E ANIMA√á√ÉO */
        .tela { display: none; padding-top: 20px; }
        .fade-in { animation: entrar 0.3s ease-out; }
        @keyframes entrar { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* ESTILO DO SOBRE */
        .caixa-sugestao { border: 1px dashed var(--neon-blue); padding: 20px; border-radius: 8px; margin-top: 30px; }
        textarea { background: #000 !important; border-color: #333 !important; color: #fff !important; }
    </style>
</head>
<body>

    <nav class="cyber-nav">
        <span style="color: #fff; font-weight:bold;">LINUX LAB_</span>
        <div>
            <a onclick="navegar('home')">HOME</a>
            <a onclick="navegar('sobre')">SOBRE</a>
        </div>
    </nav>

    <div id="tela-home" class="tela fade-in container">
        <header style="text-align: center; margin-bottom: 40px;">
            <h1 style="color: var(--neon-green); margin:0">> ARTIGOS RECENTES</h1>
            <p style="color: #666;">Otimiza√ß√£o ‚Ä¢ Hardware ‚Ä¢ Games</p>
        </header>
        <div id="lista-posts">
            <p style="text-align: center;">Carregando sistema...</p>
        </div>
    </div>

    <div id="tela-sobre" class="tela fade-in container">
        <h2 style="color: var(--neon-blue)">SOBRE O PROJETO</h2>
        <p>Bem-vindo ao <strong>Linux Lab</strong>. Este blog √© mantido por Danilo, com foco em provar que hardware antigo ainda tem valor se usado com o software correto.</p>
        
        <div class="caixa-sugestao">
            <h4 style="color: var(--neon-blue)">üí° CENTRAL DE IDEIAS</h4>
            <p><small>Tem uma dica? Envie aqui. (Limite: 1 ideia a cada 72h)</small></p>
            
            <textarea id="texto-sugestao" rows="3" placeholder="Ex: Adiciona um modo claro, fala sobre SSD..."></textarea>
            <button onclick="enviarSugestao()" class="contrast" id="btn-sugestao">ENVIAR IDEIA</button>
            <p id="msg-sugestao" style="margin-top:10px; font-weight:bold;"></p>
        </div>
    </div>

    <div id="tela-leitura" class="tela fade-in container">
        <nav><a onclick="navegar('home')" style="color: var(--neon-green); cursor:pointer;">[ ‚Üê Voltar para Lista ]</a></nav>
        
        <article id="conteudo-artigo" style="border: 1px solid #333; padding: 25px; border-radius: 8px; background: #111; margin-top:10px;">
            </article>

        <div style="margin-top: 20px; text-align: center; border-top: 1px solid #333; padding-top: 20px;">
            <p>Curtiu esse conte√∫do?</p>
            <button id="btn-curtir" class="btn-like" onclick="curtirAtual()">
                ‚ù§Ô∏è <span id="contador-likes">0</span>
            </button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <script>
        // CONFIGURA√á√ÉO
        const firebaseConfig = {
            apiKey: "AIzaSyDnkmZ7BMasKQQGnAQSTi3jxiuCbxyLU7M",
            authDomain: "meubloglinux.firebaseapp.com",
            projectId: "meubloglinux",
            storageBucket: "meubloglinux.firebasestorage.app",
            messagingSenderId: "262696388382",
            appId: "1:262696388382:web:d2784dc5dbba922cc8eb0f"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        let TODOS_POSTS = {}; 
        let ID_POST_ATUAL = null;

        // --- 1. CARREGAR POSTS ---
        db.collection("posts").orderBy("data", "desc").onSnapshot((snapshot) => {
            const listaDiv = document.getElementById('lista-posts');
            listaDiv.innerHTML = "";
            TODOS_POSTS = {};

            if(snapshot.empty) { listaDiv.innerHTML = "Nada por aqui ainda."; return; }

            snapshot.forEach((doc) => {
                const post = doc.data();
                TODOS_POSTS[doc.id] = post;
                
                // Pega curtidas (se n√£o tiver, assume 0)
                const likes = post.likes || 0;

                listaDiv.innerHTML += `
                    <div class="card-post">
                        <div style="display:flex; justify-content:space-between;">
                            <small style="color:#666">${new Date(post.data).toLocaleDateString()}</small>
                            <small>‚ù§Ô∏è ${likes}</small>
                        </div>
                        <h3>${post.titulo}</h3>
                        <button onclick="abrirArtigo('${doc.id}')" style="margin-top:10px; border-color:var(--neon-green); color:var(--neon-green); background:transparent;">LER AGORA</button>
                    </div>
                `;
            });
            checarRota();
        });

        // --- 2. NAVEGA√á√ÉO ---
        function navegar(destino) {
            document.querySelectorAll('.tela').forEach(t => t.style.display = 'none');
            
            if (destino === 'home') {
                document.getElementById('tela-home').style.display = 'block';
                location.hash = '';
            } else if (destino === 'sobre') {
                document.getElementById('tela-sobre').style.display = 'block';
                location.hash = 'sobre';
            }
        }

        function abrirArtigo(id) {
            location.hash = id;
        }

        function checarRota() {
            const hash = location.hash.replace('#', '');
            
            if (hash === 'sobre') {
                navegar('sobre');
            } else if (hash && TODOS_POSTS[hash]) {
                // Abre Artigo
                ID_POST_ATUAL = hash;
                const post = TODOS_POSTS[hash];
                const likes = post.likes || 0;

                document.getElementById('conteudo-artigo').innerHTML = `
                    <h1 style="color: var(--neon-green)">${post.titulo}</h1>
                    ${post.conteudo}
                `;
                
                // Configura bot√£o de like
                const btnLike = document.getElementById('btn-curtir');
                const contador = document.getElementById('contador-likes');
                contador.innerText = likes;

                // Verifica se j√° curtiu esse post espec√≠fico
                if (localStorage.getItem('like_' + hash)) {
                    btnLike.classList.add('curtido');
                    btnLike.disabled = true; // Bloqueia clique
                    btnLike.style.cursor = "not-allowed";
                } else {
                    btnLike.classList.remove('curtido');
                    btnLike.disabled = false;
                    btnLike.style.cursor = "pointer";
                }

                document.querySelectorAll('.tela').forEach(t => t.style.display = 'none');
                document.getElementById('tela-leitura').style.display = 'block';
                window.scrollTo(0,0);
            } else {
                navegar('home');
            }
        }
        window.addEventListener('hashchange', checarRota);

        // --- 3. SISTEMA DE LIKES (ANTI-FLOOD) ---
        function curtirAtual() {
            if (!ID_POST_ATUAL) return;

            // Bloqueio local (Visual)
            if (localStorage.getItem('like_' + ID_POST_ATUAL)) {
                alert("Voc√™ j√° curtiu este artigo!");
                return;
            }

            // 1. Marca no navegador que esse usu√°rio curtiu ESSE post
            localStorage.setItem('like_' + ID_POST_ATUAL, 'true');

            // 2. Atualiza visualmente na hora (pra ficar r√°pido)
            const btn = document.getElementById('btn-curtir');
            const contador = document.getElementById('contador-likes');
            btn.classList.add('curtido');
            contador.innerText = parseInt(contador.innerText) + 1;
            btn.disabled = true;

            // 3. Manda pro Firebase somar +1
            const incremento = firebase.firestore.FieldValue.increment(1);
            db.collection("posts").doc(ID_POST_ATUAL).update({ likes: incremento });
        }

        // --- 4. SISTEMA DE IDEIAS (ANTI-SPAM 72H) ---
        function enviarSugestao() {
            const texto = document.getElementById('texto-sugestao').value;
            const msg = document.getElementById('msg-sugestao');
            const btn = document.getElementById('btn-sugestao');

            if (!texto) { alert("Escreva algo!"); return; }

            // Verifica tempo (72 horas = 259200000 ms)
            const ultimaVez = localStorage.getItem('ultima_sugestao');
            const agora = Date.now();
            const limite = 259200000; // 72 horas

            if (ultimaVez && (agora - ultimaVez) < limite) {
                // Calcula quanto tempo falta
                const horasRestantes = Math.ceil((limite - (agora - ultimaVez)) / 3600000);
                msg.innerText = `‚è≥ Calma a√≠! Voc√™ enviou uma dica recentemente. Aguarde ${horasRestantes} horas para enviar outra.`;
                msg.style.color = "orange";
                return;
            }

            // Envia para o Firebase (Cria uma cole√ß√£o nova 'sugestoes')
            btn.setAttribute('aria-busy', 'true');
            db.collection("sugestoes").add({
                texto: texto,
                data: agora
            }).then(() => {
                // Sucesso
                localStorage.setItem('ultima_sugestao', agora); // Salva a hora
                document.getElementById('texto-sugestao').value = "";
                msg.innerText = "‚úÖ Dica enviada com sucesso! Obrigado pela contribui√ß√£o.";
                msg.style.color = "#00ff41";
                btn.setAttribute('aria-busy', 'false');
            }).catch(err => {
                console.error(err);
                msg.innerText = "Erro ao enviar.";
                btn.setAttribute('aria-busy', 'false');
            });
        }
    </script>
</body>
</html>